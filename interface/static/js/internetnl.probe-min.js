function enableResults(){var toResults=$("#continue");if(toResults.length){window.location="results";}}
function showResults(category,results){if($("#"+category+"-summary").attr('aria-busy')=="false"){return;}
if(--probesRunning<=0){enableResults();}
if(results!=undefined){var probeFinished=$("#probe-finished").text();$("#"+category+"-summary").attr('aria-busy',false).text(probeFinished);$("#"+category+"-icon").attr("src","/static/probe-animation-ready.gif");}}
function parseStatuses(json){var retry=false;for(var i=0;i<json.length;i++){var obj=json[i];if(obj.done==true){showResults(obj.name,obj);}
else{retry=true;}}
return retry;}
function showError(category){--probesRunning;var testErrorSummary=$("#probe-error-summary").html();$("#"+category+"-summary").attr('aria-busy',false).html(testErrorSummary);$("#"+category+"-icon").attr("src",'/static/probe-error.png');var testErrorNoRedirection=$("#probes-no-redirection").html();$("#continue").removeAttr("id").attr("href","/").text(testErrorNoRedirection);$(".jsless").removeClass("hidethis").attr("aria-hidden",false);}
function showErrors(){$("#probes > div").each(function(){var name=$(".probe-name",this).text();var is_busy=$("#"+name+"-summary").attr('aria-busy');if(is_busy=="true"){showError(name);}});}
function pollProbes(testurl,retryCount){if(typeof(retryCount)==='undefined'){retryCount=parseInt(javascriptRetries);}
if(retryCount<0){showErrors();}else{$.ajax({url:testurl,dataType:"json",success:function(json){var retry=parseStatuses(json);if(retry==true){setTimeout(function(){pollProbes(testurl,retryCount-1);},parseInt(javascriptTimeout));}},error:function(){showErrors();}});}};function startProbes(){$.ajaxSetup({cache:false});javascriptRetries=$("#javascript-retries").text();javascriptTimeout=$("#javascript-timeout").text();probesRunning=0;$(".probing-text").removeClass('hidethis').attr('aria-hidden',false);$("#probes > div").each(function(){++probesRunning;});probesUrl=$("#probes-url").text();pollProbes(probesUrl);}
if(window.attachEvent){window.attachEvent('onload',HideJSLess);window.attachEvent('onload',startProbes);}else if(window.addEventListener){window.addEventListener("load",HideJSLess,false);window.addEventListener("load",startProbes,false);}else{window.onload="ImageCheck();HideJSLess();startProbes();";}