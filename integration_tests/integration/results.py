# contains known good responses and results to compare/diff against

# to replicate good known results, add "assert 0" to the end of the
# "test_batch_request" to show the print statements that output the results

# taken verbatim from log output "domain results JSON"
EXPECTED_DOMAIN_RESULTS = {
    "categories": {
        "web_ipv6": {"verdict": "failed", "status": "failed"},
        "web_dnssec": {"verdict": "failed", "status": "failed"},
        "web_https": {"verdict": "failed", "status": "failed"},
        "web_appsecpriv": {"verdict": "warning", "status": "warning"},
        "web_rpki": {"verdict": "error", "status": "error"},
    },
    "tests": {
        "web_ipv6_ns_address": {"status": "failed", "verdict": "bad"},
        "web_ipv6_ns_reach": {"status": "not_tested", "verdict": "not-tested"},
        "web_ipv6_ws_address": {"status": "passed", "verdict": "good"},
        "web_ipv6_ws_reach": {"status": "passed", "verdict": "good"},
        "web_ipv6_ws_similar": {"status": "passed", "verdict": "good"},
        "web_dnssec_exist": {"status": "passed", "verdict": "good"},
        "web_dnssec_valid": {"status": "failed", "verdict": "bad"},
        "web_https_http_available": {"status": "passed", "verdict": "good"},
        "web_https_http_redirect": {"status": "passed", "verdict": "good"},
        "web_https_http_hsts": {"status": "passed", "verdict": "good"},
        "web_https_http_compress": {"status": "passed", "verdict": "good"},
        "web_https_tls_keyexchange": {"status": "passed", "verdict": "good"},
        "web_https_tls_ciphers": {"status": "passed", "verdict": "good"},
        "web_https_tls_cipherorder": {"status": "passed", "verdict": "na"},
        "web_https_tls_version": {"status": "passed", "verdict": "good"},
        "web_https_tls_compress": {"status": "passed", "verdict": "good"},
        "web_https_tls_secreneg": {"status": "passed", "verdict": "good"},
        "web_https_tls_clientreneg": {"status": "passed", "verdict": "good"},
        "web_https_cert_chain": {"status": "failed", "verdict": "bad"},
        "web_https_cert_pubkey": {"status": "passed", "verdict": "good"},
        "web_https_cert_sig": {"status": "passed", "verdict": "good"},
        "web_https_cert_domain": {"status": "passed", "verdict": "good"},
        "web_https_dane_exist": {"status": "info", "verdict": "bad"},
        "web_https_dane_valid": {"status": "not_tested", "verdict": "not-tested"},
        "web_https_tls_0rtt": {"status": "passed", "verdict": "good"},
        "web_https_tls_ocsp": {"status": "info", "verdict": "ok"},
        "web_https_tls_keyexchangehash": {"status": "passed", "verdict": "good"},
        "web_appsecpriv_x_frame_options": {"status": "passed", "verdict": "good"},
        "web_appsecpriv_referrer_policy": {"status": "passed", "verdict": "good"},
        "web_appsecpriv_csp": {"status": "warning", "verdict": "bad"},
        "web_appsecpriv_x_content_type_options": {"status": "passed", "verdict": "good"},
        "web_appsecpriv_securitytxt": {"status": "warning", "verdict": "bad"},
        "web_rpki_exists": {"status": "error", "verdict": "not-tested"},
        "web_rpki_valid": {"status": "error", "verdict": "not-tested"},
        "web_ns_rpki_exists": {"status": "not_tested", "verdict": "no-addresses"},
        "web_ns_rpki_valid": {"status": "not_tested", "verdict": "not-tested"},
    },
    "custom": {"tls_1_3_support": "yes"},
}

# taken verbatim from log output "domain technical results"
EXPECTED_DOMAIN_TECHNICAL_RESULTS = {
    "status": "ok",
    "domain": {"dnssec": {"status": "bogus"}},
    "nameservers": {},
    "webservers": {
        "ipv4": {
            "addresses": [{"address": "172.43.0.51", "reachable": True, "routing": []}],
            "https_enabled": True,
            "server_reachable": True,
            "tested_address": "172.43.0.51",
            "details": {
                "dane_status": "none",
                "dane_records": [],
                "kex_params_bad": [],
                "kex_params_phase_out": [],
                "ciphers_bad": [],
                "ciphers_phase_out": [],
                "cipher_order": "na",
                "cipher_order_violation": [],
                "protocols_bad": [],
                "protocols_phase_out": [],
                "compression": False,
                "secure_reneg": True,
                "client_reneg": False,
                "zero_rtt": "good",
                "ocsp_stapling": "ok",
                "kex_hash_func": "good",
                "https_redirect": "good",
                "http_compression": False,
                "hsts": True,
                "hsts_policies": ["max-age=31536000; includeSubdomains"],
                "cert_chain": ["test-target.internet.nl"],
                "cert_trusted": 20,
                "cert_pubkey_bad": [],
                "cert_pubkey_phase_out": [],
                "cert_signature_bad": {},
                "cert_hostmatch_bad": [],
                "content_security_policy_enabled": False,
                "content_security_policy_values": ["default-src 'self'; frame-src 'none'; frame-ancestors 'none';"],
                "content_security_policy_errors": [
                    {"msgid": "missing-invalid-base-uri", "context": {}},
                    {"msgid": "missing-invalid-form-action", "context": {}},
                ],
                "referrer_policy_enabled": True,
                "referrer_policy_values": ["no-referrer"],
                "x_content_type_options_enabled": True,
                "x_content_type_options_values": ["nosniff"],
                "x_frame_options_enabled": True,
                "x_frame_options_values": ["SAMEORIGIN"],
                "securitytxt_enabled": True,
                "securitytxt_errors": [{"msgid": "no_canonical_match", "context": {"line_no": None}}],
                "securitytxt_recommendations": [],
                "securitytxt_found_host": "1691507713.target.test",
            },
        },
        "ipv6": {
            "addresses": [{"address": "fd00:43:1::51", "reachable": True, "routing": []}],
            "https_enabled": True,
            "server_reachable": True,
            "tested_address": "fd00:43:1::51",
            "details": {
                "dane_status": "none",
                "dane_records": [],
                "kex_params_bad": [],
                "kex_params_phase_out": [],
                "ciphers_bad": [],
                "ciphers_phase_out": [],
                "cipher_order": "na",
                "cipher_order_violation": [],
                "protocols_bad": [],
                "protocols_phase_out": [],
                "compression": False,
                "secure_reneg": True,
                "client_reneg": False,
                "zero_rtt": "good",
                "ocsp_stapling": "ok",
                "kex_hash_func": "good",
                "https_redirect": "good",
                "http_compression": False,
                "hsts": True,
                "hsts_policies": ["max-age=31536000; includeSubdomains"],
                "cert_chain": ["test-target.internet.nl"],
                "cert_trusted": 20,
                "cert_pubkey_bad": [],
                "cert_pubkey_phase_out": [],
                "cert_signature_bad": {},
                "cert_hostmatch_bad": [],
                "content_security_policy_enabled": False,
                "content_security_policy_values": ["default-src 'self'; frame-src 'none'; frame-ancestors 'none';"],
                "content_security_policy_errors": [
                    {"msgid": "missing-invalid-base-uri", "context": {}},
                    {"msgid": "missing-invalid-form-action", "context": {}},
                ],
                "referrer_policy_enabled": True,
                "referrer_policy_values": ["no-referrer"],
                "x_content_type_options_enabled": True,
                "x_content_type_options_values": ["nosniff"],
                "x_frame_options_enabled": True,
                "x_frame_options_values": ["SAMEORIGIN"],
                "securitytxt_enabled": True,
                "securitytxt_errors": [{"msgid": "no_canonical_match", "context": {"line_no": None}}],
                "securitytxt_recommendations": [],
                "securitytxt_found_host": "1691507713.target.test",
            },
        },
    },
}
